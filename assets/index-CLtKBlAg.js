var N=Object.defineProperty;var O=(e,t,s)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var r=(e,t,s)=>O(e,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();class h{constructor(t,s){r(this,"x");r(this,"y");this.x=t,this.y=s}copy(){return new h(this.x,this.y)}equals(t){return this.x==t.x&&this.y==t.y}add(t){this.x+=t.x,this.y+=t.y}sub(t){this.x-=t.x,this.y-=t.y}mult(t){this.x*=t,this.y*=t}div(t){this.x/=t.x,this.y/=t.y}magSquared(){return this.x**2+this.y**2}mag(){return Math.sqrt(this.magSquared())}static getMult(t,s){return new h(t.x*s,t.y*s)}static getSub(t,s){return new h(t.x-s.x,t.y-s.y)}static dot(t,s){return t.x*s.x+t.y*s.y}normalize(){this.mult(1/this.mag())}}class f{constructor(t,s,i){r(this,"x");r(this,"y");r(this,"w");r(this,"children");r(this,"leaf");r(this,"body");r(this,"totalCenter");r(this,"center");r(this,"totalMass");r(this,"count");this.x=t,this.y=s,this.w=i,this.leaf=!0,this.body=null,this.children=new Array(4),this.totalCenter=new h(0,0),this.center=null,this.totalMass=0,this.count=0}split(){const t=this.w*.5;this.children[0]=new f(this.x,this.y,t),this.children[1]=new f(this.x+t,this.y,t),this.children[2]=new f(this.x,this.y+t,t),this.children[3]=new f(this.x+t,this.y+t,t),this.leaf=!1}which(t){const s=this.w*.5;return t.y<this.y+s?t.x<this.x+s?0:1:t.x<this.x+s?2:3}insert(t){if(this.leaf){if(!this.body){this.body=t,this.totalCenter.add(t.pos),this.totalMass+=t.mass,this.count++;return}const s=this.body,i=t;this.totalCenter.add(i.pos),this.totalMass+=i.mass,this.count++;let n=this,o=n.which(s.pos),a=n.which(i.pos);for(;o==a;)n.split(),n=n.children[o],o=n.which(s.pos),a=n.which(i.pos),n.totalCenter.add(s.pos),n.totalCenter.add(i.pos),n.totalMass+=s.mass+i.mass,n.count+=2;n.split(),n.children[o].body=s,n.children[a].body=i,n.children[o].totalCenter.add(s.pos),n.children[a].totalCenter.add(i.pos),n.children[o].totalMass+=s.mass,n.children[a].totalMass+=i.mass,n.children[o].count++,n.children[a].count++,this.body=null;return}this.totalCenter.add(t.pos),this.totalMass+=t.mass,this.count++,this.children[this.which(t.pos)].insert(t)}}var p=({min:e,max:t,inclusive:s="true true",containsDecimals:i=!1})=>{if(typeof e!="number"||typeof t!="number")throw new Error(`min and max must be numbers, received types: [${typeof e}, ${typeof t}]`);if(typeof i!="boolean")throw new Error(`containsDecimals must be a boolean, received type: ${typeof i}`);if(typeof s!="string")throw new Error(`inclusive must be a string, received type: ${typeof s}`);if(e>=t)throw new Error(`min must be less than max, received: [${e}, ${t}]`);switch(s){case"true true":return i?Math.random()*(t-e+1)+e:Math.floor(Math.random()*(t-e+1))+e;case"true false":return i?Math.random()*(t-e)+e:Math.floor(Math.random()*(t-e))+e;case"false false":return i?Math.random()*(t-e-1)+e+1:Math.floor(Math.random()*(t-e-1))+e+1;case"false true":return i?Math.random()*(t-e)+e+1:Math.floor(Math.random()*(t-e))+e+1;default:throw new Error(`Invalid inclusive value: "${s}". Inclusive must be one of the following: "true true", "true false", "false false", "false true"`)}};class P{constructor(t,s,i,n,o){r(this,"pos");r(this,"vel");r(this,"mass");r(this,"radius");r(this,"nextPos");r(this,"nextVel");r(this,"heat");this.pos=t,this.nextPos=t.copy(),this.nextVel=s.copy(),this.vel=s,this.mass=i,this.radius=n,this.heat=o}update(t){this.vel.mult(t),this.pos.add(this.vel),this.heat*=.997}}const R=.05,z=.4;function U(e,t,s){e.forEach(i=>{X(i,t,s)})}function X(e,t,s){if(t.leaf){if(!t.body||e==t.body)return;e.vel.add(S(t.body.pos,e,s));return}if(t.center||(t.center=h.getMult(t.totalCenter,1/t.count)),t.w/H(e.pos,t.center)<z){e.vel.add(S(t.center,e,t.totalMass));return}t.children.forEach(i=>X(e,i,s))}function S(e,t,s){const i=B(e,t.pos);return i<=2*(t.radius*t.radius)?new h(0,0):h.getMult(h.getSub(e,t.pos),s*R*t.mass/(i*Math.sqrt(i)))}function H(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function B(e,t){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)}const F=250,W=5,G=2,m=document.getElementById("canvas"),C=m.getContext("2d");C.canvas.width=window.innerHeight-100;C.canvas.height=window.innerHeight-100;m.width=window.innerHeight-100;m.height=window.innerHeight-100;const c={N:F,r:W,mass:G,canvas:m,ctx:C},K=.2;function T(e,t){e.forEach(s=>{s.nextPos=s.pos.copy(),s.nextVel=s.vel.copy()}),e.forEach(s=>$(s,t)),e.forEach(s=>{s.pos=s.nextPos,s.vel=s.nextVel})}function $(e,t){if(t.leaf){if(!t.body||e==t.body)return;const s=H(e.pos,t.body.pos);j(e,t.body,s);return}t.children.forEach(s=>{e.pos.x+2*e.radius<s.x||e.pos.x-2*e.radius>s.x+s.w||e.pos.y+2*e.radius<s.y||e.pos.y-2*e.radius>s.y+s.w||$(e,s)})}function j(e,t,s){if(s>e.radius+t.radius)return;const i=h.getSub(e.pos,t.pos);i.normalize();const n=1/(e.heat+1),o=1/(t.heat+1),a=h.getMult(i,(e.radius+t.radius-s)*n/(n+o));e.nextPos.add(a);const u=h.dot(h.getSub(e.vel,t.vel),i);e.heat+=Math.abs(u)*.1;const d=h.getMult(i,u*(1+K)*.5);e.nextVel.sub(d),e.nextVel.mult(.95)}function k(e){const t=c.ctx.canvas.width;return e.pos.x+e.radius>t||e.pos.x-e.radius<0||e.pos.y+e.radius>t||e.pos.y-e.radius<0}const J=e=>{const t=document.getElementById("canvas2"),s=t.getContext("2d");s.canvas.width=window.innerHeight-100,s.canvas.height=window.innerHeight-100,t.width=window.innerHeight-100,t.height=window.innerHeight-100;const i=t.getBoundingClientRect();let n=!1,o,a,u;t.addEventListener("mousedown",d=>{n=!0,o=d.clientX-i.left,a=d.clientY-i.top}),t.addEventListener("mousemove",d=>{if(s.clearRect(0,0,t.width,t.height),n){const g=d.clientX-i.left,M=d.clientY-i.top,q=Math.sqrt(Math.pow(g-o,2)+Math.pow(M-a,2)),v=g-o,E=M-a,A=Math.sqrt(v*v+E*E),Y=v/A,I=E/A;q>2&&(s.beginPath(),s.moveTo(o,a),s.lineTo(g,M),s.strokeStyle="white",s.lineWidth=2,s.stroke()),u=new h(Y,I),u.mult(q/30)}}),t.addEventListener("mouseup",()=>{e(o,a,u),n=!1,o=0,a=0,u=null,s.clearRect(0,0,t.width,t.height)}),t.addEventListener("mouseleave",()=>{n=!1,s.clearRect(0,0,t.width,t.height)})},L=c.ctx.canvas.width,y=.005;let l=[],x;function Q(){for(let e=0;e<c.N;e++){const t=new h(p({min:0,max:L-c.r}),p({min:0,max:L-c.r})),s=new h(p({min:-y,max:y}),p({min:-y,max:y}));l.push(new P(t,s,c.mass,c.r,0))}}function Z(){let e=Number.MAX_VALUE,t=-Number.MAX_VALUE,s=Number.MAX_VALUE,i=-Number.MAX_VALUE;for(let n=0;n<c.N;n++)l[n]&&(e=Math.min(e,l[n].pos.x),t=Math.max(t,l[n].pos.x),s=Math.min(s,l[n].pos.y),i=Math.max(i,l[n].pos.y));return[e,s,Math.max(t-e,i-s)]}function D(){const e=Z();x=new f(e[0],e[1],e[2]),l.forEach(t=>x.insert(t))}function _(e){l.forEach(t=>t.update(1)),D(),U(l,x,e),T(l,x),l=l.filter(t=>!k(t)),c.ctx.fillStyle="black",c.ctx.fillRect(0,0,c.canvas.width,c.canvas.height),c.ctx.lineWidth=2,l.forEach(t=>{c.ctx.strokeStyle=tt(t.heat/12),c.ctx.beginPath(),c.ctx.arc(t.pos.x,t.pos.y,t.radius,0,2*Math.PI),c.ctx.stroke()})}let w=0;function V(e){w||(w=e);const t=(e-w)/1e3;w=e,_(t),requestAnimationFrame(V)}function b(e,t,s){const i=new h(e,t),n=new h(s.x,s.y);l.push(new P(i,n,32,c.r,0))}Q();requestAnimationFrame(V);J(b);function tt(e){e=Math.max(0,Math.min(1,e));const t=Math.round(500*e),s=Math.round(500*(1-e));return`rgb(${t}, ${s}, 0)`}
